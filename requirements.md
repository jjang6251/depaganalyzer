# 📄 Stablecoin Simulator 요구사항 정의서 (requirements.md)

## 1. 프로젝트 개요
본 프로젝트는 주요 스테이블코인(USDT, USDC, DAI)의 **페깅 안정성(1 USD 유지 여부)**을 실데이터와 시뮬레이션을 통해 비교 분석하는 것을 목표로 한다.  
또한, 담보형·알고리즘형·하이브리드형 모델을 시뮬레이션하여 **시장 충격 상황**에서의 거동을 관찰하고, **정량적 리스크 지표**를 산출한다.

---

## 2. 시스템 목표
- **데이터 기반 안정성 분석**: 실시간/과거 시세 데이터를 수집하여 안정성 지표 산출
- **시뮬레이션 엔진**: 다양한 스테이블코인 모델(담보형, 알고리즘형, 하이브리드) 시뮬레이션
- **스트레스 테스트**: 대량 환매, 담보 급락, 오라클 지연 등 외부 충격에 대한 반응 관찰
- **리스크 평가**: 괴리율, 변동성, 페깅 유지율, 회복 시간 등 핵심 지표 계산
- **결과 제공**: REST API, 대시보드, PDF/HTML 리포트

---

## 3. 사용자 시나리오 (Use Cases)
1. **연구자/학생**
    - 특정 기간 동안 USDT, USDC, DAI의 안정성 비교
    - 디페그(depeg) 사건 재현 및 분석
2. **개발자**
    - 새로운 스테이블코인 모델 설계 후 시뮬레이션 실행
    - 다양한 파라미터 조합으로 안정성 실험
3. **금융기관/핀테크 팀 (가정)**
    - 스트레스 테스트를 통해 잠재적 리스크 평가
    - 결과 리포트를 기반으로 의사결정 참고

---

## 4. 기능 요구사항 (Functional Requirements)

### 4.1 데이터 수집 및 저장
- 외부 시세 API(CoinGecko, Binance 등)에서 USDT, USDC, DAI 가격 데이터 수집
- 수집 주기: 분/시/일 단위
- PostgreSQL(TimescaleDB) 또는 H2(개발 단계) DB에 저장
- Redis 캐시를 통한 최신 데이터 조회 성능 향상

### 4.2 시뮬레이션 엔진
- 입력 파라미터:
    - 모델 유형 (RESERVE, ALGO, HYBRID)
    - 시뮬레이션 스텝 수 (예: 10,000)
    - Δt (시간 간격)
    - 담보 비율 (LTV)
    - 환매 수수료율
    - 오라클 지연 시간
    - 초기 공급량 및 리저브
- 출력 결과:
    - 시뮬레이션 시계열 (가격, 공급량, 리저브, pegDeviation)
    - 이벤트 로그 (충격 발생, 정책 발동 시점)

### 4.3 스트레스 시나리오
- Redeem Shock: 특정 시점에 전체 공급량의 X% 환매 발생
- Collateral Drop: 담보 자산 가격이 Y% 하락
- Oracle Lag: 오라클 데이터 반영 지연 (예: 60초)

### 4.4 리스크 지표
- 평균 괴리율: `mean(|p - 1.0|)`
- 변동성(σ): 로그 수익률 표준편차
- 페깅 유지율: 가격이 `[0.995 ~ 1.005]` 범위에 머문 비율
- 회복 시간: 충격 발생 → 1.0±ε 복귀까지 걸린 스텝 수
- 최대 낙폭(Max Drawdown): 디페그 최대 하강폭

### 4.5 API (MVP 범위)
- `GET /api/assets/{symbol}/metrics?from&to`  
  특정 스테이블코인의 기간별 지표 조회
- `POST /api/simulations`  
  시뮬레이션 실행 요청 (모델/파라미터 입력)
- `GET /api/simulations/{id}`  
  특정 시뮬레이션 결과 조회
- `POST /api/reports`  
  시뮬레이션 결과를 PDF/HTML 리포트로 변환

---

## 5. 비기능 요구사항 (Non-functional Requirements)

### 5.1 성능
- 10만 스텝 시뮬레이션 5분 이내 수행
- 외부 API 장애 시 캐시 및 리트라이 처리

### 5.2 보안
- JWT 기반 인증/인가
- 주요 엔드포인트에 Rate Limiting 적용
- 감사 로그 기록 (사용자, 시뮬레이션 실행 내역)

### 5.3 신뢰성
- 시뮬레이션 입력 파라미터 검증 (잘못된 값/NaN 방지)
- 시드(seed) 고정 옵션 제공 → 동일 조건 시 재현 가능

### 5.4 배포/운영
- Docker 기반 배포
- GitHub Actions CI/CD 적용
- 로그/모니터링(AWS CloudWatch, ELK 등 선택 가능)

---

## 6. MVP 범위 (Phase 1)
- USDT, USDC, DAI 시세 데이터 수집
- 담보형(Reserve-backed) 모델 시뮬레이션
- 스트레스 테스트(환매, 담보 하락) 2종
- 리스크 지표 3개 (괴리율, 변동성, 페깅 유지율)
- REST API 제공 (Swagger 문서 포함)
- PDF 리포트 1종 생성

---

## 7. 확장 범위 (Phase 2)
- 알고리즘/하이브리드 모델 추가
- 스트레스 테스트 종류 확장 (오라클 지연, 수수료 조정)
- React 대시보드 시각화
- Batch Simulation (파라미터 스윕)
- 실시간 경보 시스템 (Slack/Webhook)

---

## 8. 제약 조건
- 실데이터는 공개 API 의존 → 호출 제한(rate limit)에 영향 받을 수 있음
- 금융/투자 조언을 제공하지 않으며, 연구용 시뮬레이터로 한정
- 초기 버전은 단일 서버에서 동작 (수평 확장은 선택 사항)

---

## 9. 성공 기준 (KPI)
- 3가지 이상의 스트레스 시나리오를 실행하고 결과 지표 산출 가능
- 실데이터 vs 시뮬레이션 비교 결과를 리포트로 제공
- GitHub Actions 빌드 성공률 100%
- README + 요구사항 + API 문서(OpenAPI) 공개

---